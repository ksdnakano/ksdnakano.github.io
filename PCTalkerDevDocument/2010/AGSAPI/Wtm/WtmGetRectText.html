<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<title>WtmGetRectText</title>
<link href="../../2010.css" rel="stylesheet" type="text/css">
<style type="text/css">
<!--
.style1 {
	color: #FF0000;
	font-weight: bold;
}
-->
</style>
</head>

<body>
<p class="title">矩形内の文字列取得　WtmGetRectText</p>
<p><strong>BOOL WtmGetRectText( HWND </strong><em>aWnd</em><strong> , RECT </strong><em>aRect</em><strong>,AGSWGRT_REQUEST </strong><em>aRequest</em><strong>,wchar_t* </strong><em>wcTextBuf</em><strong>, size_t* </strong><em>nMoji </em><strong>);</strong></p>
<p>指定された矩形内の文字列を取得します。</p>
<p>この関数をコールする前に、<a href="WtmProcessMonitor.html">WtmProcessMonitor</a>、または<a href="WtmWindowMonitor.html">WtmWindowMonitor</a>で描画の監視を開始しておく必要があります。</p>
<p class="subtitle">引 数</p>
<table width="662" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="126" valign="top" class="tblhead"><em>aWnd</em><strong></strong></td>
    <td width="536" valign="top">描画監視中のウインドウ</td>
  </tr>
  <tr>
    <td valign="top" class="tblhead"><em>aRect</em></td>
    <td valign="top">取得する文字列が含まれる矩形(ウインドウ左隅からの相対位置)</td>
  </tr>
  <tr>
    <td valign="top" class="tblhead"><em>aRequest</em><strong></strong></td>
    <td valign="top"><p>取得方法</p>
      <table width="554" border="1">
        <tr>
          <td width="182"><strong>AGSWGRT_SURROUNDED</strong></td>
          <td width="362">矩形で完全に囲まれるテキストを取得</td>
        </tr>
        <tr>
          <td><strong>AGSWGRT_VISIBLE</strong></td>
          <td>矩形内に見えているテキストを取得</td>
        </tr>
        <tr>
          <td><strong>AGSWGRT_ORIGIN</strong></td>
          <td>左上隅の原点が矩形内にあるテキストを取得</td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td valign="top" class="tblhead"><em>wcTextBuf</em><strong></strong></td>
    <td valign="top">取得文字列</td>
  </tr>
  <tr>
    <td valign="top" class="tblhead"><em>nMoji</em></td>
    <td valign="top"><p>取得した文字数</p>
    <p class="style1">※wcTextBufのサイズ(最大文字数)で初期化しておく必要があります。</p></td>
  </tr>
</table>
<p><span class="subtitle">戻り値</span></p>
<table width="665" border="1" cellspacing="0" cellpadding="1">
  <tr>
    <td width="122" valign="top" class="tblhead">BOOL</td>
    <td width="533"><table>
        <tr>
          <td width="304"><strong>TRUE</strong>=成功</td>
        <tr>
          <td><strong>FALSE</strong>=失敗</td>
        </tr>
    </table></td>
  </tr>
</table>
<p class="subtitle">&nbsp;</p>
</body>
</html>
